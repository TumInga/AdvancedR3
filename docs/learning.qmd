---
title: "Advanced R course set up pipeline with targets"
author: "Inga Tummoszeit"
format: html
editor: visual
---

## Set up targets

```{r setup}
library(tidyverse)
library(targets)
tar_config_set(store = here::here("_targets"))
source(here::here("R/functions.R"))
lipodomics <- tar_read(lipidomics)
```

## Making a table

```{r}
lipodomics %>%
  group_by(metabolite) %>%
  summarise(across(value, list(mean = mean, sd = sd))) %>%
  mutate(across(where(is.numeric), \(x) sprintf("%.1f", round(x, digits = 1)))) %>%
  mutate(MeanSD = glue::glue("{value_mean} ({value_sd})")) %>%
  select(Metabolite = metabolite, "Mean SD" = MeanSD)
```

## Results: basic stats table

```{r}
tar_read(table_descriptive_stats) |>
  knitr::kable(
    caption = "The mean and standard deviation of metabolites in the lipidomics dataset"
  )
```

## Results: basic stats table with gt

```{r}
tar_read(table_descriptive_stats) |>
  gt::gt() |>
  gt::tab_header(
    title = "The mean and standard deviation of metabolites in the lipidomics dataset",
    subtitle = "with gt package"
  )

#   data_color( apply_to = "text", colors='white')
```

## Plot of distributions

```{r}
ggplot(lipodomics, aes(x = value)) +
  geom_histogram() +
  facet_wrap(vars(metabolite), scales = "free") + # it is variable and the scale is free (for each histogram)
  theme_minimal()
```

```{r}
```

## Running Code

When you click the **Render** button a document will be generated that
includes both content and the output of embedded code. You can embed
code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is
displayed).

## This is poorly formatted

-   Definitely should have an empty space above this list.
-   This isn't a list, why not?
